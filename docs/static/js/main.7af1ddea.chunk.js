(this["webpackJsonpnegoziacf-app"]=this["webpackJsonpnegoziacf-app"]||[]).push([[0],{165:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(36),i=n.n(a),c=n(61),s=n(14),o=n(13),l=n(222),u=n(226),d=n(223),j=n(172),h=n(216),b=n(221),p=n(106),m=n.n(p),x=n(5),O=n(82),v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(r.useState)(e),n=Object(o.a)(t,2),a=n[0],i=n[1],c=function(){i(e)},s=function(e){var t=e.target;i(Object(O.a)(Object(O.a)({},a),{},Object(x.a)({},t.name,t.value)))};return[a,s,c]},f=n(30),g=n.n(f),w=n(64),y=n.n(w),k=n(2),E=Object(r.createContext)({user:void 0,setUser:function(){}}),C=function(e){var t=e.children,n=Object(r.useState)(void 0),a=Object(o.a)(n,2),i=a[0],c=a[1];return Object(r.useEffect)((function(){var e=localStorage.getItem("user");e&&c(JSON.parse(e))}),[]),Object(k.jsx)(E.Provider,{value:{user:i,setUser:c},children:t})},S=function(){var e=Object(s.g)(),t=v({loginEmail:"",loginPassword:""}),n=Object(o.a)(t,2),a=n[0],i=n[1],c=Object(r.useContext)(E).setUser,p=a.loginEmail,x=a.loginPassword,O={margin:"9px 0"},f={margin:"9px 0"};return Object(k.jsx)(l.a,{children:Object(k.jsxs)(u.a,{elevation:10,style:{padding:20,height:"70vh",width:280,margin:"20px auto"},children:[Object(k.jsxs)(l.a,{align:"center",children:[Object(k.jsxs)(d.a,{style:{backgroundColor:"#1bbd7e"},children:[Object(k.jsx)(m.a,{})," "]}),Object(k.jsx)(j.a,{children:"Sign in"})]}),Object(k.jsxs)("form",{onSubmit:function(t){t.preventDefault(),g()({method:"post",url:"https://mern-negozia.herokuapp.com/api/auth",data:{email:p,password:x}}).then((function(t){var n,r=null===t||void 0===t?void 0:t.data;(null===r||void 0===r?void 0:r.ok)?(c(r),localStorage.setItem("user",JSON.stringify(r)),e("/user")):y.a.fire("Error",null===r||void 0===r||null===(n=r.data)||void 0===n?void 0:n.msg,"error")}),(function(e){}))},children:[Object(k.jsx)(h.a,{style:f,label:"Email",placeholder:"Enter Email",fullWidth:!0,required:!0,name:"loginEmail",value:p,onChange:i}),Object(k.jsx)(h.a,{style:f,label:"Password",placeholder:"Enter password",type:"password",fullWidth:!0,required:!0,name:"loginPassword",value:x,onChange:i}),Object(k.jsx)(b.a,{type:"submit",color:"primary",fullWidth:!0,variant:"contained",style:O,children:"Sign in"})]}),Object(k.jsxs)(j.a,{children:[" Do you have an account?",Object(k.jsx)(b.a,{color:"primary",style:O,onClick:function(){return e("/create")},variant:"contained",children:"Sign Up?"})]})]})})},W=n(24),I=n.n(W),N=n(34),U=n(215),z=n(219),D={margin:"9px 0"},q={margin:"9px 0"},A=function(e){var t,n,r,a=e.user,i=e.handleSubmitForm,c={admin:"ADMIN",user:"USER"},s=v({name:null!==(t=null===a||void 0===a?void 0:a.name)&&void 0!==t?t:"",email:null!==(n=null===a||void 0===a?void 0:a.email)&&void 0!==n?n:"",role:null!==(r=null===a||void 0===a?void 0:a.role)&&void 0!==r?r:"",password1:"",password2:""}),l=Object(o.a)(s,2),u=l[0],d=l[1],j=u.name,p=u.email,m=u.role,x=u.password1,O=u.password2;return Object(k.jsxs)("form",{onSubmit:function(e){e.preventDefault(),i(u,null===a||void 0===a?void 0:a.id)},children:[Object(k.jsx)(h.a,{name:"name",value:j,onChange:d,type:"text",style:q,label:"Name",placeholder:"Enter Name",fullWidth:!0,required:!0}),Object(k.jsx)(h.a,{name:"email",value:p,onChange:d,type:"text",style:q,label:"Email",placeholder:"Enter Email",fullWidth:!0,required:!0}),Object(k.jsx)(U.a,{name:"role",value:m,onChange:d,type:"text",style:q,label:"Role",placeholder:"Enter Role",fullWidth:!0,required:!0,children:Object.keys(c).map((function(e,t){return Object(k.jsx)(z.a,{value:c[e],children:c[e]},t)}))}),!a&&Object(k.jsx)(h.a,{name:"password1",value:x,onChange:d,style:q,label:"Password",placeholder:"Enter password",type:"password",fullWidth:!0,required:!0}),!a&&Object(k.jsx)(h.a,{name:"password2",value:O,onChange:d,style:q,label:"Password",placeholder:"Repeat password",type:"password",fullWidth:!0,required:!0}),Object(k.jsx)(b.a,{type:"submit",color:"primary",fullWidth:!0,variant:"contained",style:D,children:a?"Update":"Create"})]})},P=function(){var e=Object(N.a)(I.a.mark((function e(t){var n,r,a,i,c,s;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.name,r=t.email,a=t.password1,i=t.role,e.prev=1,e.next=4,g()({method:"post",url:"https://mern-negozia.herokuapp.com/api/users",data:{name:n,email:r,password:a,role:i}});case 4:return c=e.sent,s=c.data,e.abrupt("return",s);case 9:e.prev=9,e.t0=e.catch(1);case 11:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),R=function(){var e=Object(s.g)(),t=function(){var t=Object(N.a)(I.a.mark((function t(n){var r,a,i,c,s;return I.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.password1,a=n.password2,i=n.name,c=n.email,s=n.role,r===a){t.next=3;break}return t.abrupt("return",y.a.fire("Error","Las contrase\xf1as deben de ser iguales","error"));case 3:return t.next=5,P({name:i,email:c,password1:r,role:s});case 5:t.sent.ok?e("/user"):e("/");case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(k.jsx)(l.a,{children:Object(k.jsxs)(u.a,{elevation:10,style:{padding:20,height:"70vh",width:280,margin:"20px auto"},children:[Object(k.jsx)(l.a,{align:"center",children:Object(k.jsx)(j.a,{children:"Create User"})}),Object(k.jsx)(A,{user:void 0,handleSubmitForm:t})]})})},J=n(236),M=n(235),F=n(237),B=n(107),G=n.n(B),L=function(){var e=Object(r.useContext)(E),t=e.user,n=e.setUser,a=Object(s.g)();return Object(k.jsx)(M.a,{sx:{flexGrow:1},children:Object(k.jsx)(J.a,{position:"static",children:Object(k.jsxs)(F.a,{children:[Object(k.jsxs)(j.a,{variant:"h6",component:"div",sx:{flexGrow:1},children:["Bienvenido ",null===t||void 0===t?void 0:t.name]}),"ADMIN"===(null===t||void 0===t?void 0:t.role)&&Object(k.jsxs)(b.a,{color:"inherit",onClick:function(){return a("/create")},children:[Object(k.jsx)(G.a,{}),"Create"]}),Object(k.jsx)(b.a,{color:"inherit",onClick:function(){localStorage.removeItem("user"),n(void 0),a("/")},children:"Logout"})]})})})},H=n(228),K=n(232),Q=n(231),T=n(227),V=n(229),X=n(230),Y=n(108),Z=n.n(Y),$=n(109),_=n.n($),ee=function(){var e=Object(N.a)(I.a.mark((function e(t){var n;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g()({method:"get",url:"https://mern-negozia.herokuapp.com/api/users/",headers:{"x-token":t}});case 3:return n=e.sent,e.abrupt("return",n);case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),te=n(238),ne=n(214),re=n(239),ae=function(){var e=Object(r.useState)([]),t=Object(o.a)(e,2),n=t[0],a=t[1],i=Object(r.useContext)(E).user,c=Object(r.useState)(void 0),s=Object(o.a)(c,2),l=s[0],d=s[1],j=function(){var e=Object(N.a)(I.a.mark((function e(){var t;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ee(i.token);case 2:t=e.sent,a(t.data.user);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(r.useEffect)((function(){j()}));return Object(k.jsxs)("div",{children:[Object(k.jsx)(L,{}),Object(k.jsx)(T.a,{component:u.a,children:Object(k.jsxs)(H.a,{sx:{minWidth:700},"aria-label":"customized table",children:[Object(k.jsx)(V.a,{children:Object(k.jsxs)(X.a,{children:[Object(k.jsx)(Q.a,{align:"left",children:"id"}),Object(k.jsx)(Q.a,{align:"right",children:"Name"}),Object(k.jsx)(Q.a,{align:"right",children:"Email"}),Object(k.jsx)(Q.a,{align:"right",children:"Role"}),"ADMIN"===(null===i||void 0===i?void 0:i.role)&&Object(k.jsx)(Q.a,{align:"right",children:"Actions"})]})}),Object(k.jsx)(K.a,{children:n.map((function(e){return e.isActive?Object(k.jsxs)(X.a,{children:[Object(k.jsx)(Q.a,{align:"left",children:e.id}),Object(k.jsx)(Q.a,{align:"right",children:e.name}),Object(k.jsx)(Q.a,{align:"right",children:e.email}),Object(k.jsx)(Q.a,{align:"right",children:e.role}),"ADMIN"===(null===i||void 0===i?void 0:i.role)&&Object(k.jsxs)(Q.a,{align:"right",children:[Object(k.jsxs)(b.a,{onClick:function(){return d(e)},children:[Object(k.jsx)(Z.a,{}),"Edit"]}),Object(k.jsxs)(b.a,{onClick:function(){return t=e.id,void g()({method:"patch",url:"https://mern-negozia.herokuapp.com/api/users/".concat(t),headers:{"x-token":i.token},data:{isActive:!1}}).then((function(e){j()}),(function(e){}));var t},children:[Object(k.jsx)(_.a,{}),"Delete"]})]})]},e.id):null}))})]})}),Object(k.jsxs)(te.a,{open:!!l,onClose:function(){return d(void 0)},children:[Object(k.jsx)(ne.a,{children:"Edit User"}),Object(k.jsx)(re.a,{children:Object(k.jsx)(A,{user:l,handleSubmitForm:function(e,t){var n=e.name,r=e.email,a=e.role;g()({method:"patch",url:"https://mern-negozia.herokuapp.com/api/users/".concat(t),headers:{"x-token":i.token},data:{name:n,email:r,role:a}}).then((function(e){d(void 0),j()}),(function(e){}))}})})]})]})},ie=function(){var e=localStorage.getItem("user");return Object(k.jsx)(c.a,{children:Object(k.jsxs)(s.d,{children:[Object(k.jsx)(s.b,{path:"/",element:Object(k.jsx)(S,{})}),Object(k.jsx)(s.b,{path:"/create",element:Object(k.jsx)(R,{})}),Object(k.jsx)(s.b,{path:"/user",element:e?Object(k.jsx)(ae,{}):Object(k.jsx)(s.a,{replace:!0,to:"/"})})]})})},ce=function(){return Object(k.jsx)(C,{children:Object(k.jsx)(ie,{})})};i.a.render(Object(k.jsx)(ce,{}),document.getElementById("root"))}},[[165,1,2]]]);
//# sourceMappingURL=main.7af1ddea.chunk.js.map